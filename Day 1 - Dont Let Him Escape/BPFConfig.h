#pragma once

/*
	BPF_MAP_LOOKUP_ELEM
	Look up an element by key in a  specified  map  and  return  its
	value.

	BPF_MAP_UPDATE_ELEM
	Create or update an element (key/value pair) in a specified map.
*/


#define ldabsh 0xFFFFFFFFa3119ea4
#define ldindb 0xFFFFFFFFA3119EB8
#define ldabsb 0xFFFFFFFFA3119EC0
#define ldindh 0xFFFFFFFFA3119E9C
#define ldindw 0xFFFFFFFFA3119E83
#define BPF_MAP_LOOKUP_ELEM 0xFFFFFFFFA31E2BF3
#define BPF_MAP_UPDATE_ELEM 0xFFFFFFFFA31E2C03

/*
	The key packet to craft
*/
unsigned char udp_packet_pcap_key[] = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x08, 0x00,
	0x45, 0x00,
	0x00, 0x41, //IP.LEN
	0xb3, 0xfa, 0x40, 0x00, 0x40, 0x11, 0x88, 0xc4,
	0x7f, 0x00, 0x00, 0x01, 0x7f, 0x00, 0x00, 0x01, 0xc7, 0x08, 0x05, 0x39,
	0x00, 0x25 //DATA LEN 0x25=KEY 0x16=LUM
	, 0xfe, 0x2b, //Checksum
	'K','E','Y','{',
	'A','E','C','0',
	'5','1','9','A',
	'F','A','B','0',
	'A','A','2','3',
	'F','C','3','6',
	'0','B','5','5',
	'2','9','1','D',//'D','1','9','2',
	'E','7','C','9',//'9','C','7','E',
	'}'
};

// KEY{AEC0519AFAB0AA23FC360B55291DE7C9}'
// KEY{AEC0 519A FAB0 AA23 FC36 0B55 291D E7C9}
// KEY{0CEAA9150BAF32AA63FC55B0D1929C7E}

// The crafted LUM packet (working)
unsigned char udp_packet_pcap[] = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x08, 0x00,
	0x45, 0x00,
	0x00, 0x2C, //IP.LEN 2C == LUM LEN
	0xb3, 0xfa, 0x40, 0x00, 0x40, 0x11, 0x88, 0xc4,
	0x7f, 0x00, 0x00, 0x01, 0x7f, 0x00, 0x00, 0x01, 0xc7, 0x08,
	0x05, 0x39, //UDP DESTPort
	0x00, 0x18, //UDP LENGTH
	0xfe, 0x2b, //Checksum
	//VALID LUM
	0x4c, 0x55, 0x4d, 0x7b, 0x42, 0x76, 0x57, 0x51,
	0x45, 0x64, 0x43, 0x72, 0x4d, 0x66, 0x41, 0x7d
};


// LUM{}
